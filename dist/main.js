!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=0)}([function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t);var a=4,s=3.5,r=.5,h=.2,o=.05,l=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.car=t,this.x=window.innerWidth/2,this.y=window.innerHeight/2,this.vx=0,this.vy=0,this.speed=0,this.reverseSpeed=0,this.angle=0,this.omega=0,this.mass=1,this.accelerate=!1,this.reverse=!1,this.turnLeft=!1,this.turnRight=!1,document.addEventListener("keydown",(function(e){if(!e.defaultPrevented){switch(e.code){case"KeyA":case"ArrowLeft":i.turnLeft=!0;break;case"KeyD":case"ArrowRight":i.turnRight=!0;break;case"KeyW":case"ArrowUp":i.accelerate=!0;break;case"KeyS":case"ArrowDown":i.reverse=!0;break;case"Space":i.break=!0,0!=i.speed&&(i.speed-=1.2,i.speed<0&&(i.speed=0))}e.preventDefault()}})),document.addEventListener("keyup",(function(e){if(!e.defaultPrevented){switch(e.code){case"KeyA":case"ArrowLeft":i.turnLeft=!1;break;case"KeyD":case"ArrowRight":i.turnRight=!1;break;case"KeyW":case"ArrowUp":i.accelerate=!1;break;case"KeyS":case"ArrowDown":i.reverse=!1;break;case"Space":i.break=!1}e.preventDefault()}}))}var t,i,l;return t=e,(i=[{key:"reset",value:function(){this.x=window.innerWidth/2,this.y=window.innerHeight/2,this.vx=0,this.vy=0,this.speed=0,this.reverseSpeed=0,this.angle=0,this.omega=0,this.mass=1,this.accelerate=!1,this.reverse=!1,this.turnLeft=!1,this.turnRight=!1,this.car.style.transform="translate(".concat(window.innerWidth/2,"px, ").concat(window.innerHeight/2,"px) rotate(",0,"deg)"),this.car.style.opacity="0.5"}},{key:"renderCrash",value:function(){}},{key:"move",value:function(){var e=a,t=r,i=h,n=s,l=o;this.accelerate?this.speed+=t:this.speed-=i,this.reverse?this.reverseSpeed+=t:this.reverseSpeed-=i,this.speed=Math.min(e,Math.max(this.speed,0)),this.reverseSpeed=Math.min(n,Math.max(this.reverseSpeed,0));var c=this.speed>=this.reverseSpeed?1:-1;this.turnRight&&(this.speed>.1||this.reverseSpeed>.1)?this.omega=c*l:this.turnLeft&&(this.speed>.1||this.reverseSpeed>.1)?this.omega=-c*l:this.omega=0,this.vx=Math.sin(this.angle)*(this.speed-this.reverseSpeed),this.vy=Math.cos(this.angle)*(this.speed-this.reverseSpeed),this.x+=this.vx,this.y-=this.vy,this.angle+=this.omega,this.omega*=this.omega,this.x>window.innerWidth?this.x-=window.innerWidth:this.x<0&&(this.x+=window.innerWidth),this.y>window.innerHeight?this.y-=window.innerHeight:this.y<0&&(this.y+=window.innerHeight)}},{key:"checkCollisionWithBall",value:function(e){var t,i,n=Math.cos(this.angle)*(e.x-this.x)-Math.sin(this.angle)*(e.y-this.y)+this.x,a=Math.sin(this.angle)*(e.x-this.x)+Math.cos(this.angle)*(e.y-this.y)+this.y;return t=n<this.x?this.x:n>this.x+16?this.x+16:n,i=a<this.y?this.y:a>this.y+32?this.y+16:a,Math.sqrt((n-t)*(n-t)+(a-i)*(a-i))<=e.radius}},{key:"drawCar",value:function(){this.car.style.transform="translate(".concat(this.x,"px, ").concat(this.y,"px) rotate(").concat(180*this.angle/Math.PI,"deg)")}}])&&n(t.prototype,i),l&&n(t,l),e}();function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t,i){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.radius=i.radius,this.x=i.x,this.y=i.y,this.color=i.color,this.vel=i.vel,this.angle=i.angle,this.mass=this.radius,this.img=new Image,this.img.onload=function(){return n.draw(t)},this.img.src="src/assets/images/no_parking.png",this.vx=this.vel*Math.cos(this.angle),this.vy=this.vel*Math.sin(this.angle)}var t,i,n;return t=e,(i=[{key:"draw",value:function(e){e.save(),e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI),e.closePath(),e.clip(),e.drawImage(this.img,this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius),e.restore()}},{key:"move",value:function(){var e=[this.vx,this.vy],t=e[0],i=e[1];this.x+=t,this.y+=i,this.x>window.innerWidth?this.x-=window.innerWidth:this.x<0&&(this.x+=window.innerWidth),this.y>window.innerHeight?this.y-=window.innerHeight:this.y<0&&(this.y+=window.innerHeight)}},{key:"isColliding",value:function(e){var t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)<this.radius+e.radius}},{key:"animate",value:function(){this.move(),this.draw(this.ctx)}}])&&c(t.prototype,i),n&&c(t,n),e}();function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var v=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.running=!0,this.level=1,this.car=i,this.timer=n,this.balls=[],this.lives=5,this.hearts=document.querySelectorAll("div.lives li"),this.time=null,this.pX=0,this.pY=0,this.img=new Image,this.img.src="src/assets/images/parking.png"}var t,i,n;return t=e,n=[{key:"onCollision",value:function(e,t){var i=t.x-e.x,n=t.y-e.y,a=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),s=i/a,r=n/a,h=(e.vx-t.vx)*s+(e.vy-t.vy)*r,o=2*h/(e.mass+t.mass);h<0||(e.vx-=o*t.mass*s,e.vy-=o*t.mass*r,t.vx+=o*e.mass*s,t.vy+=o*e.mass*r)}}],(i=[{key:"addBalls",value:function(){if(1===this.level)for(var e=0;e<15;e++)this.addBall(30,5)}},{key:"drawParkingSpot",value:function(){for(var e=Math.floor(Math.random()*(window.innerWidth-60)),t=Math.floor(Math.random()*(window.innerHeight-60));e>window.innerWidth/2-150&&e<window.innerWidth/2+150;)e=Math.floor(Math.random()*(window.innerWidth-60));for(;t>window.innerHeight/2-150&&t<window.innerHeight/2+150;)t=Math.floor(Math.random()*(window.innerHeight-60));this.pX=e,this.pY=t}},{key:"animateParkingSpot",value:function(){this.ctx.fillStyle="#0071cc",this.ctx.fillRect(this.pX,this.pY,60,60)}},{key:"carCrashed",value:function(){--this.lives,this.updateHearts(),this.reset()}},{key:"addBall",value:function(e,t){var i={radius:e,x:Math.floor(Math.random()*window.innerWidth),y:Math.floor(Math.random()*window.innerHeight),color:"blue",vel:t,angle:Math.random()*Math.PI*2},n=new d(this.ctx,i);this.balls.push(n)}},{key:"checkBallCollision",value:function(){for(var t=0;t<this.balls.length;t++)for(var i=t+1;i<this.balls.length;i++)this.balls[t].isColliding(this.balls[i])&&e.onCollision(this.balls[t],this.balls[i])}},{key:"reset",value:function(){var e=this;this.balls=[],this.addBalls(),this.car.reset(),this.time=(new Date).getTime(),setTimeout((function(){e.car.car.style.opacity="1"}),1500)}},{key:"checkParked",value:function(){var e=this.car,t=[e.x+8*Math.cos(e.angle)+16*Math.sin(e.angle),e.x-8*Math.cos(e.angle)+16*Math.sin(e.angle),e.x-8*Math.cos(e.angle)-16*Math.sin(e.angle),e.x+8*Math.cos(e.angle)-16*Math.sin(e.angle)],i=[e.y+8*Math.sin(e.angle)-16*Math.cos(e.angle),e.y-8*Math.sin(e.angle)-16*Math.cos(e.angle),e.y-8*Math.sin(e.angle)+16*Math.cos(e.angle),e.y+8*Math.sin(e.angle)+16*Math.cos(e.angle)],n=Math.min.apply(Math,t),a=Math.max.apply(Math,t),s=Math.min.apply(Math,i),r=Math.max.apply(Math,i);return![n>this.pX&&n<this.pX+60,a>this.pX&&a<this.pX+60,s>this.pY&&s<this.pY+60,r>this.pY&&r<this.pY+60].includes(!1)}},{key:"parked",value:function(){var e=this.timer.timerDisplay.innerHTML;null===localStorage.getItem("park-it-time")&&localStorage.setItem("park-it-time",e),new Date("1970-01-01 ".concat(e))<new Date("1970-01-01 ".concat(localStorage.getItem("park-it-time")))&&(localStorage.removeItem("park-it-time"),localStorage.setItem("park-it-time",e));var t=localStorage.getItem("park-it-time");document.querySelector(".win-lose span").innerHTML="Your best time: ".concat(t),document.querySelector(".actual-time span").innerHTML="Time: ".concat(e),this.restart()}},{key:"start",value:function(){var e=this;this.addBalls(),this.timer.startTimer(),this.time=(new Date).getTime(),setTimeout((function(){e.car.car.style.opacity="1"}),1500),this.drawParkingSpot()}},{key:"restart",value:function(){var e=this.ctx;e.fillStyle="wheat",e.fillRect(0,0,e.canvas.width,e.canvas.height),this.balls=[],this.car.reset(),this.timer.resetTimer(),this.timer.timerDisplay.innerHTML="00:00:00",this.lives||(document.querySelector("div.win-lose span").innerHTML="You got a parking ticket",document.querySelector("div.actual-time span").innerHTML=""),this.lives=5,this.updateHearts(),document.getElementById("modal").style.visibility="visible"}},{key:"gameOver",value:function(){return!this.lives}},{key:"updateHearts",value:function(){for(var e=0;e<this.hearts.length;e++)this.hearts[e].style.opacity=e<this.lives?1:.2}},{key:"animate",value:function(){var e=this,t=this.ctx;t.fillStyle="wheat",t.fillRect(0,0,t.canvas.width,t.canvas.height),this.animateParkingSpot(),this.balls.forEach((function(e){e.animate()})),this.balls.forEach((function(t){e.car.checkCollisionWithBall(t)&&(new Date).getTime()-e.time>1500&&e.carCrashed()})),this.checkBallCollision()}}])&&u(t.prototype,i),n&&u(t,n),e}();function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startTime=0,this.tInterval=0,this.updatedTime=0,this.savedTime=0,this.difference=0,this.running=!1,this.paused=!1,this.timerDisplay=t,this.getShowTime=this.getShowTime.bind(this)}var t,i,n;return t=e,(i=[{key:"startTimer",value:function(){this.running||(this.startTime=(new Date).getTime(),this.tInterval=window.setInterval(this.getShowTime,1),this.running=!0,this.paused=!1)}},{key:"pauseTimer",value:function(){this.difference&&(this.paused?this.startTimer():(clearInterval(this.tInterval),this.savedTime=this.difference,this.paused=!0,this.running=!1))}},{key:"resetTimer",value:function(){clearInterval(this.tInterval),this.savedTime=0,this.difference=0,this.paused=!1,this.running=!1}},{key:"getShowTime",value:function(){this.updatedTime=(new Date).getTime(),this.savedTime?this.difference=this.updatedTime-this.startTime+this.savedTime:this.difference=this.updatedTime-this.startTime;var e=Math.floor(this.difference%36e5/6e4),t=Math.floor(this.difference%6e4/1e3),i=Math.floor(this.difference%6e4/10)%100;e=e<10?"0"+e:e,t=t<10?"0"+t:t,i=i<100?i<10?"0"+i:""+i:i,this.timerDisplay.innerHTML="".concat(e,":").concat(t,":").concat(i)}}])&&m(t.prototype,i),n&&m(t,n),e}();document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector("a.start"),t=document.querySelector("a.restart-button"),i=document.getElementById("modal"),n=document.getElementById("main-game"),a=n.getContext("2d");n.height=window.innerHeight,n.width=window.innerWidth;var s=document.getElementById("local"),r=document.querySelector(".timer span"),h=new f(r),o=new l(s),c=new v(a,o,h);function d(){return c.gameOver()?(window.cancelAnimationFrame(window.animationId),void c.restart()):c.checkParked()?(window.cancelAnimationFrame(window.animationId),void c.parked()):(o.move(),o.drawCar(),c.animate(),void(window.animationId=window.requestAnimationFrame(d)))}s.style.transform="translate(".concat(window.innerWidth/2,"px, ").concat(window.innerHeight/2,"px) rotate(",0,"deg)"),s.style.opacity="0.5",window.localStorage.getItem("park-it-time")&&window.localStorage.removeItem("park-it-time"),window.restartBtn=t,t.addEventListener("click",(function(){i.style.visibility="hidden",e.style.visibility="visible"})),e.addEventListener("click",(function(){e.style.visibility="hidden",c.start(),d()}))}))}]);
//# sourceMappingURL=main.js.map